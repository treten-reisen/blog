---
import * as dateFns from "date-fns"

import type { StrapiArticleListItem } from "../../data/get-article-list"
import { encodeImageToBlurhashURL } from "../../helpers/blurhash"
import LazyImage from "../lazy-image"

export type Props = { article: StrapiArticleListItem }

const { article } = Astro.props as Props
const blurhash = await encodeImageToBlurhashURL(article.attributes.image)
---

<a href={`/articles/${article.attributes.slug}`} class="flex flex-col gap-2">
  <header class="flex flex-col">
    <div class="mb-3 h-52 lg:h-64">
      <LazyImage
        blurhashConfig={blurhash}
        src={article.attributes.image.htmlImage.src || undefined}
        alt={article.attributes.image.htmlImage.alt || undefined}
        loading="lazy"
        client:load
      />
    </div>
    <time class="font-sans text-sm text-gray-500" datetime={dateFns.format(article.attributes.createdAt, "yyyy-MM-dd")}>
      {
        dateFns.intlFormat(
          article.attributes.createdAt,
          { year: "numeric", month: "long", day: "numeric" },
          { locale: "de" }
        )
      }
    </time>
    <h3 class="font-sans text-lg font-bold tracking-tight text-gray-700">{article.attributes.title}</h3>
  </header>
  <div class="font-sans tracking-tight text-gray-600">{article.attributes.summary}</div>
</a>
